<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content=
    "application/xhtml+xml; charset=iso-8859-1" />
    <title>
      7.13.&nbsp;Configuring the network Script
    </title>
    <link rel="stylesheet" href="../stylesheets/lfs.css" type="text/css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.73.2" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="lfs" id="lfs-6.6">
    <div class="navheader">
      <h4>
        Linux From Scratch - Version 6.6
      </h4>
      <h3>
        Chapter&nbsp;7.&nbsp;&#37197;&#32622;&#31995;&#32479;&#21551;&#21160;&#33050;&#26412;</h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="hosts.html" title=
          "Customizing the /etc/hosts File">&#21518;&#36864;</a>
          <p>
            &#23450;&#21046; /etc/hosts &#25991;&#20214; 
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="../chapter08/chapter08.html" title=
          "Making the LFS System Bootable">&#21069;&#36827;</a>
          <p>
            &#20351; LFS &#31995;&#32479;&#33021;&#22815;&#21551;&#21160;</p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter07.html" title=
          "Chapter&nbsp;7.&nbsp;Setting Up System Bootscripts">&#19978;&#19968;&#32423;</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - Version 6.6">&#39318;&#39029;</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="en" xml:lang="en">
      <h1 class="sect1">
        <a id="ch-scripts-network" name="ch-scripts-network"></a>7.13.
        &#37197;&#32622;&#32593;&#32476;&#33050;&#26412; 
      </h1>
      <p>&#26412;&#33410;&#20165;&#36866;&#29992;&#20110;&#38656;&#35201;&#37197;&#32622;&#32593;&#21345;&#30340;&#24773;&#20917;&#12290;</p>
      <p>
        &#22914;&#26524;&#19981;&#20351;&#29992;&#32593;&#21345;&#65292;&#23601;&#19981;&#38656;&#35201;&#21019;&#24314;&#20851;&#32852;&#32593;&#21345;&#30340;&#37197;&#32622;&#25991;&#20214;&#65292;&#36825;&#26679;&#30340;&#35805;&#65292;&#22312;&#25152;&#26377;&#36816;&#34892;&#32423;&#30446;&#24405; (<code class=
        "filename">/etc/rc.d/rc*.d</code>) &#19979;&#21024;&#38500; network &#31526;&#21495;&#38142;&#25509;&#12290; </p>
      <div class="sect2" lang="en" xml:lang="en">
        <h2 class="sect2">
        7.13.1.&#21019;&#24314;&#32593;&#32476;&#25509;&#21475;&#30340;&#31283;&#23450;&#21517;&#31216;        </h2>
        <p>
          &#30001;&#20110; Udev &#21644;&#32593;&#32476;&#39537;&#21160;&#30340;&#27169;&#22359;&#21270;&#65292;&#32593;&#32476;&#35774;&#22791;&#30340;&#25509;&#21475;&#30340;&#21152;&#36733;&#39034;&#24207;&#22312;&#27599;&#27425;reboot&#21518;&#21487;&#33021;&#20250;&#19981;&#21516;&#65292; &#22240;&#20026;&#39537;&#21160;&#26159;&#24182;&#34892;&#21152;&#36733;&#30340;&#65292;&#25152;&#20197;&#39034;&#24207;&#20250;&#38543;&#26426;&#21464;&#21270;&#12290;   &#20363;&#22914;&#65292;&#22312;&#19968;&#21488;&#35745;&#31639;&#26426;&#19978;&#26377;&#20004;&#22359;&#32593;&#21345; Intel &#21644; Realtek&#65292; Intel&#21046;&#36896;&#30340;&#32593;&#21345;&#21487;&#33021;&#26159; eth0&#65292;Realtelk &#30340;&#32593;&#21345;&#26159; eth1&#12290;   &#26377;&#26102;&#65292; &#37325;&#21551;&#21518;&#32593;&#21345;&#30340;&#39034;&#24207;&#21487;&#33021;&#21453;&#36807;&#26469;&#12290; &#20026;&#36991;&#20813;&#36825;&#31181;&#24773;&#20917;&#65292;Udev &#38468;&#24102;&#19968;&#20010;&#33050;&#26412;&#21644;&#19968;&#20123;&#35268;&#21017;&#26469;&#26681;&#25454;&#32593;&#21345;&#30340;MAC&#22320;&#22336;&#32473;&#23427;&#20204;&#23450;&#20041;&#31283;&#23450;&#30340;&#21517;&#31216;&#12290;</p>
        <p>&#39044;&#29983;&#25104;&#30340;&#35268;&#21017;&#65292;&#35201;&#30830;&#20445;&#27599;&#27425;&#21551;&#21160;&#65292;&#21516;&#26679;&#30340;&#21517;&#23383;&#37117;&#20998;&#37197;&#32473;&#21516;&#19968;&#20010;&#35774;&#22791;&#65292;&#21253;&#25324;&#31532;&#19968;&#27425;&#21551;&#21160;&#65306;</p>
        <pre class="userinput"><kbd class=
        "command">for NIC in /sys/class/net/* ; do
    INTERFACE=${NIC##*/} udevadm test --action=add $NIC
done</kbd></pre>
        <p>&#29616;&#22312;&#65292;&#26816;&#26597; <code class=
          "filename">/etc/udev/rules.d/70-persistent-net.rules</code>&#25991;&#20214;&#65292;&#25214;&#20986;&#21517;&#23383;&#21644;&#32593;&#21345;&#30340;&#23545;&#24212;&#20851;&#31995;&#65306;</p>
        <pre class="userinput"><kbd class=
        "command">cat /etc/udev/rules.d/70-persistent-net.rules</kbd></pre>
        <p>&#36825;&#20010;&#25991;&#20214;&#24635;&#26159;&#20197;&#19968;&#20010;&#27880;&#37322;&#22359;&#24320;&#22987;&#65292;&#28982;&#21518;&#23545;&#20110;&#27599;&#20010;NIC&#26377;&#20004;&#34892;&#12290; &#27599;&#20010;NIC&#30340;&#31532;&#19968;&#34892;&#26159;&#26174;&#31034;&#23427;&#30340;&#30828;&#20214;ID&#65288;&#20363;&#22914;&#65292;&#22914;&#26524;&#26159;PCI&#21345;&#65292;&#23601;&#26159;&#23427;&#30340; PCI   &#20379;&#24212;&#21830;&#21644;&#35774;&#22791;ID&#65289; &#30340;&#27880;&#37322;&#20449;&#24687;&#65292; &#22914;&#26524;&#21487;&#20197;&#25214;&#21040;&#39537;&#21160;&#31243;&#24207;&#30340;&#35805;&#65292;&#20250;&#22312;&#25324;&#21495;&#20013;&#38468;&#24102;&#39537;&#21160;&#31243;&#24207;&#12290; &#19981;&#31649;&#26159;&#30828;&#20214; ID   &#36824;&#26159;&#39537;&#21160;&#31243;&#24207;&#65292;&#37117;&#21487;&#20197;&#29992;&#26469;&#20915;&#23450;&#36825;&#20010;&#32593;&#21345;&#30340;&#21517;&#31216;&#12290;&#31532;&#20108;&#34892;&#26159;&#21305;&#37197;&#36825;&#20010;NIC&#30340; Udev &#35268;&#21017;&#65292; &#20197;&#21450;&#23454;&#38469;&#20998;&#37197;&#32473;&#23427;&#30340;&#21517;&#23383;&#12290; </p>
        <p>&#25152;&#26377; Udev &#35268;&#21017;&#37117;&#30001;&#19968;&#20123;&#34987;&#36887;&#21495;&#21644;&#21487;&#36873;&#30340;&#31354;&#26684;&#20998;&#24320;&#30340;&#20851;&#38190;&#23383;&#32452;&#25104;&#12290; &#35268;&#21017;&#20851;&#38190;&#23383;&#21644;&#23427;&#20204;&#30340;&#35828;&#26126;&#35831;&#21442;&#32771;&#19979;&#38754;&#65306;</p>
        <div class="itemizedlist">
          <ul>
            <li>
              <p>
                <code class="literal">SUBSYSTEM=="net"</code> - &#35813;&#21442;&#25968;&#21578;&#35785; Udev &#24573;&#30053;&#38750;&#32593;&#21345;&#35774;&#22791;</p>
            </li>
            <li>
              <p>
                <code class="literal">ACTION=="add"</code> - &#35813;&#21442;&#25968;&#21578;&#35785; Udev &#24573;&#30053;&#19981;&#38468;&#21152;&#20107;&#20214;&#30340;&#35268;&#21017; (&#20063;&#21457;&#29983; &quot;&#21024;&#38500;&quot; &#21644; &quot;&#26356;&#25913;&quot; &#20107;&#20214;&#65292;&#20294;&#19981;&#24517;&#37325;&#21629;&#21517;&#32593;&#32476;&#25509;&#21475; )&#12290;</p>
            </li>
            <li>
              <p>
                <code class="literal">DRIVERS=="?*"</code> - &#35813;&#36873;&#39033;&#20351; Udev &#24573;&#30053; VLAN &#25110;&#26725;&#23376;&#25509;&#21475; (&#22240;&#20026;&#36825;&#20123;&#23376;&#25509;&#21475;&#27809;&#26377;&#39537;&#21160;)&#12290; &#22240;&#20026;&#20998;&#37197;&#32473;&#23376;&#25509;&#21475;&#30340;&#21517;&#23383;&#20250;&#21644;&#29238;&#35774;&#22791;&#26377;&#20914;&#31361;&#65292;&#25152;&#20197;&#35201;&#36339;&#36807;&#12290;</p>
            </li>
            <li>
              <p>
                <code class="literal">ATTR{address}</code> - &#36825;&#20010;&#20851;&#38190;&#23383;&#30340;&#20540;&#26159;&#32593;&#21345;&#30340; MAC&#22320;&#22336;&#12290; </p>
            </li>
            <li>
              <p>
                <code class="literal">ATTR{type}=="1"</code> - &#26576;&#20123;&#26080;&#32447;&#39537;&#21160;&#20250;&#24314;&#31435;&#22810;&#20010;&#34394;&#25311;&#25509;&#21475;&#65292;&#22312;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292; &#35813;&#21442;&#25968;&#30830;&#20445;&#36825;&#20010;&#35268;&#21017;&#21482;&#21305;&#37197;&#20027;&#25509;&#21475; &#12290; &#21644;VLAN&#21644;&#26725;&#23376;&#25509;&#21475;&#34987;&#36339;&#36807;&#30340;&#21407;&#22240;&#19968;&#26679;&#65306;&#26377;&#21629;&#21517;&#20914;&#31361;&#65292;   &#25152;&#20197;&#65292;&#31532;&#20108;&#20010;&#25509;&#21475;&#20250;&#34987;&#36339;&#36807;&#12290;</p>
            </li>
            <li>
              <p>
                <code class="literal">KERNEL=="eth*"</code> - &#36825;&#20010;&#20851;&#38190;&#23383;&#28155;&#21152;Udev&#35268;&#21017;&#29983;&#25104;&#22120;&#65292;&#29992;&#26469;&#22788;&#29702;&#26377;&#22810;&#20010;&#30456;&#21516;MAC&#22320;&#22336;&#32593;&#32476;&#25509;&#21475;&#30340;&#26426;&#22120; &#65288;PS3&#23601;&#26159;&#19968;&#31181;&#36825;&#26679;&#30340;&#26426;&#22120;&#65289;&#12290;&#22914;&#26524;&#29420;&#31435;&#30340;&#25509;&#21475;&#26377;&#19981;&#21516;&#30340;&#22522;&#26412;&#21517;&#65288;basenames&#65289;&#65292;&#36825;&#20010;   &#20851;&#38190;&#23383;&#20250;&#35753;Udev&#21578;&#35785;&#23427;&#20204;&#20998;&#24320;&#12290; &#36825;&#20010;&#21442;&#25968;&#23545;&#20110;&#22823;&#22810;&#25968;LFS&#29992;&#25143;&#37117;&#19981;&#26159;&#24517;&#38656;&#30340;&#65292;&#20294;&#26080;&#25152;&#35859;&#12290;</p>
            </li>
            <li>
              <p>
                <code class="literal">NAME</code> - &#36825;&#20010;&#20851;&#38190;&#23383;&#30340;&#20540;&#26159;Udev&#23558;&#35201;&#20998;&#37197;&#32473;&#36825;&#20010;&#31471;&#21475;&#30340;&#21517;&#23383;</p>
            </li>
          </ul>
        </div>
        <p><code class="literal">NAME</code>&#30340;&#20540;&#26159;&#37325;&#35201;&#30340;&#32452;&#25104;&#37096;&#20998;&#12290; &#22312;&#25191;&#34892;&#21069;&#35201;&#30830;&#20445;&#20320;&#30693;&#36947;&#20998;&#37197;&#32473;&#27599;&#20010;&#32593;&#21345;&#30340;&#21517;&#23383;&#65292; &#24182;&#19988;&#65292; &#35201;&#30830;&#20445;&#22312;&#21518;&#38754;&#24314;&#31435;&#37197;&#32622;&#25991;&#20214;&#26102;&#65292;&#20351;&#29992;&#20102;&#36825;&#20010;NAME &#20540;&#12290;</p>
      </div>
      <div class="sect2" lang="en" xml:lang="en">
        <h2 class="sect2">
        7.13.2.&#21019;&#24314;&#32593;&#32476;&#25509;&#21475;&#37197;&#32622;&#25991;&#20214;        </h2>
        <p>network &#33050;&#26412;&#21551;&#29992;&#25110;&#20851;&#38381;&#21738;&#20010;&#25509;&#21475;&#30001; <code class=
          "filename">/etc/sysconfig/network-devices</code>&#30446;&#24405;&#19979;&#30340;&#25991;&#20214;&#20915;&#23450;&#12290; &#36825;&#20010;&#30446;&#24405;&#20026;&#27599;&#20010;&#37197;&#32622;&#30340;&#32593;&#32476;&#25509;&#21475;&#24314;&#31435;&#19968;&#20010;&#23376;&#30446;&#24405;&#65292;&#31867;&#20284;&#20110; <code class="filename">ifconfig.xyz</code>&#65292;&#36825;&#20010; &ldquo;xyz&rdquo; &#26159;&#19968;&#20010;&#32593;&#32476;&#25509;&#21475;&#30340;&#21517;&#23383;&#12290; &#36825;&#20010;&#30446;&#24405;&#20013;&#30340;&#25991;&#20214;&#23558;&#23450;&#20041;&#25509;&#21475;&#30340;&#23646;&#24615;&#65292;&#27604;&#22914;IP&#22320;&#22336;&#12289;&#23376;&#32593;&#25513;&#30721;&#31561;&#31561;&#12290;</p>
        <p>
          &#19979;&#38754;&#30340;&#21629;&#20196;&#26159;&#20026;  <span class=
          "emphasis"><em>eth0</em></span> &#24314;&#31435;&#19968;&#20010;&#20107;&#20363;&#30340; <code class=
          "filename">ipv4</code> &#25991;&#20214;&#65306;</p>
        <pre class="userinput"><kbd class=
        "command">cd /etc/sysconfig/network-devices
mkdir -v ifconfig.eth0
cat &gt; ifconfig.eth0/ipv4 &lt;&lt; "EOF"
<code class="literal">ONBOOT=yes
SERVICE=ipv4-static
IP=192.168.1.1
GATEWAY=192.168.1.2
PREFIX=24
BROADCAST=192.168.1.255</code>
EOF</kbd></pre>
        <p>&#27599;&#20010;&#25991;&#20214;&#20013;&#30340;&#36825;&#20123;&#21464;&#37327;&#30340;&#20540;&#37117;&#35201;&#25913;&#25104;&#24744;&#30340;&#35774;&#32622;&#65292;&#22914;&#26524; <code class="envar">ONBOOT</code>
          &#21464;&#37327;&#35774;&#32622;&#25104; &ldquo;<span class="quote">yes</span>&rdquo;&#65292; 
          network &#33050;&#26412;&#20250;&#22312;&#31995;&#32479;&#21551;&#21160;&#36807;&#31243;&#20013;&#21551;&#21160;&#32593;&#32476;&#25509;&#21475;&#21345; (NIC)&#12290; &#22914;&#26524;&#35774;&#32622;&#25104;
          &ldquo;<span class="quote">yes</span>&rdquo; &#20197;&#22806;&#30340;&#20540;&#65292; NIC &#20250;&#34987; network &#33050;&#26412;&#24573;&#30053;&#32780;&#19981;&#21551;&#21160;&#12290;</p>
        <p><code class="envar">SERVICE</code> &#21464;&#37327;&#23450;&#20041;&#33719;&#21462; IP &#22320;&#22336;&#30340;&#26041;&#24335;&#65292; LFS-Bootscripts &#36719;&#20214;&#21253;&#26377;&#19968;&#22871;&#27169;&#22359;&#21270;&#30340; IP &#20998;&#37197;&#26684;&#24335;&#65292;&#24182;&#22312; <code class=
          "filename">/etc/sysconfig/network-devices/services</code> &#30446;&#24405;&#19979;&#20026;&#20854;&#23427;&#30340; IP &#20998;&#37197;&#26041;&#24335;&#21019;&#24314;&#20102;&#38468;&#21152;&#30340;&#25991;&#20214;&#65292; &#36825;&#36890;&#24120;&#29992;&#20316;&#21160;&#24577;&#20027;&#26426;&#37197;&#32622;&#21327;&#35758; (DHCP)&#26041;&#24335;&#65292; &#22312;BLFS &#37324;&#26377;&#35814;&#32454;&#20171;&#32461;&#12290;</p>
        <p><code class="envar">GATEWAY</code> &#21464;&#37327;&#24212;&#35813;&#35774;&#32622;&#20026;&#40664;&#35748;&#32593;&#20851;&#30340; IP &#22320;&#22336;&#65288;&#22914;&#26524;&#23384;&#22312;&#30340;&#35805;&#65289;&#65292; &#22914;&#26524;&#27809;&#26377;&#40664;&#35748;&#32593;&#20851;&#65292;&#23601;&#25226;&#36825;&#20010;&#21464;&#37327;&#27880;&#37322;&#25481;&#12290;</p>
        <p><code class="envar">PREFIX</code> &#21464;&#37327;&#35774;&#32622;&#20026;&#23376;&#32593;&#20351;&#29992;&#30340;&#20301;&#25968;&#12290;IP&#22320;&#22336;&#30340;&#27599;&#20010;&#23383;&#33410;&#26159;8&#20301;&#12290;&#22914;&#26524;&#23376;&#32593;&#25513;&#30721;&#26159; 255.255.255.0&#65292; &#37027;&#20040;&#23427;&#20351;&#29992;&#21069;3&#20010;&#23383;&#33410; (24 bits) &#26469;&#25351;&#23450;&#32593;&#32476;&#21495;&#12290;&#22914;&#26524;&#23376;&#32593;&#25513;&#30721;&#26159; 255.255.255.240&#65292; &#23427;&#23601;&#26159;&#20351;&#29992;28&#20301;&#25351;&#23450;&#32593;&#32476;&#21495;&#12290;&#38271;&#20110;24&#20301;&#30340;<code class="envar">PREFIX</code> &#36890;&#24120;&#30001; DSL &#21644;
          cable&#30340;&#22240;&#29305;&#32593;&#26381;&#21153;&#25552;&#20379;&#21830;(ISP)&#20351;&#29992;&#12290;&#22312;&#36825;&#20010;&#20363;&#23376;&#37324;
          (PREFIX=24)&#65292;&#23376;&#32593;&#25513;&#30721;&#26159; 255.255.255.0&#12290;&#35831;&#26681;&#25454;&#20320;&#30340;&#32593;&#32476;&#24773;&#20917;&#35843;&#25972;<code class=
          "envar">PREFIX</code>&#21464;&#37327;&#12290;</p>
      </div>
      <div class="sect2" lang="en" xml:lang="en">
        <h2 class="sect2">
          <a id="resolv.conf" name="resolv.conf"></a>7.13.3. &#24314;&#31435;
          /etc/resolv.conf &#25991;&#20214;</h2>
        <p>
          &#22914;&#26524;&#31995;&#32479;&#35201;&#36830;&#25509;&#21040;Internet&#19978;&#65292;&#23601;&#38656;&#35201;&#22495;&#21517;&#26381;&#21153;(DNS) &#26469;&#25226;Internet&#22495;&#21517;&#35299;&#26512;&#25104;IP&#22320;&#22336;&#65292;&#21453;&#20043;&#20134;&#28982;&#12290;&#22312;<code class=
          "filename">/etc/resolv.conf</code>&#25991;&#20214;&#37324;&#35774;&#32622; ISP &#25110;&#32593;&#32476;&#31649;&#29702;&#21592;&#25552;&#20379;&#30340;&#22495;&#21517;&#26381;&#21153;&#22120;&#30340; IP &#22320;&#22336;&#23601;&#21487;&#20197;&#36798;&#21040;&#36825;&#20010;&#30446;&#30340;&#20102;&#65292;&#36816;&#34892;&#19979;&#38754;&#30340;&#21629;&#20196;&#21019;&#24314;&#36825;&#20010;&#25991;&#20214;&#65306;</p>
        <pre class="userinput"><kbd class=
        "command">cat &gt; /etc/resolv.conf &lt;&lt; "EOF"
<code class="literal"># Begin /etc/resolv.conf

domain <em class="replaceable"><code>&lt;Your Domain Name&gt;</code></em>
nameserver <em class=
"replaceable"><code>&lt;IP address of your primary nameserver&gt;</code></em>
nameserver <em class=
"replaceable"><code>&lt;IP address of your secondary nameserver&gt;</code></em>

# End /etc/resolv.conf</code>
EOF</kbd></pre>
        <p>
          &#25226;<em class="replaceable"><code>&lt;IP address of the
          nameserver&gt;</code></em> &#26367;&#25442;&#25104;&#20320;&#30340;DNS&#30340;IP&#22320;&#22336;&#12290; &#22495;&#21517;&#26381;&#21153;&#22120;&#24120;&#24120;&#19981;&#27490;&#19968;&#39033;(&#20316;&#20026;&#22791;&#20221;&#29992;&#36884;)&#65292;&#22914;&#26524;&#24744;&#21482;&#38656;&#35201;&#19968;&#20010;&#22495;&#21517;&#26381;&#21153;&#22120;&#65292;&#25226;&#25991;&#20214;&#37324;&#30340;&#31532;&#20108;&#34892; <em>nameserver</em> &#21024;&#38500;&#23601;&#21487;&#20197;&#20102;&#12290;&#22312;&#23616;&#22495;&#32593;&#37324;&#36825;&#20010; IP &#22320;&#22336;&#36824;&#21487;&#33021;&#26159;&#36335;&#30001;&#22120;&#12290;</p>
      </div>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="hosts.html" title=
          "Customizing the /etc/hosts File">&#21518;&#36864;</a>
          <p>
            &#23450;&#21046; /etc/hosts &#25991;&#20214; 
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="../chapter08/chapter08.html" title=
          "Making the LFS System Bootable">&#21069;&#36827;</a>
          <p>
            &#20351; LFS &#31995;&#32479;&#33021;&#22815;&#21551;&#21160;</p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter07.html" title=
          "Chapter&nbsp;7.&nbsp;Setting Up System Bootscripts">&#19978;&#19968;&#32423;</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - Version 6.6">&#39318;&#39029;</a>
        </li>
      </ul>
    </div>
  </body>
</html>
