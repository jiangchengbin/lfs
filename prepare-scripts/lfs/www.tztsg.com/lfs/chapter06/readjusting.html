<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content=
    "application/xhtml+xml; charset=iso-8859-1" />
    <title>
      6.10.&nbsp;Re-adjusting the Toolchain
    </title>
    <link rel="stylesheet" href="../stylesheets/lfs.css" type="text/css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.73.2" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="lfs" id="lfs-6.6">
    <div class="navheader">
      <h4>
        Linux From Scratch - Version 6.6
      </h4>
      <h3>
        Chapter&nbsp;6.&nbsp;&#23433;&#35013;&#22522;&#30784;&#31995;&#32479;&#36719;&#20214;
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="glibc.html" title="Glibc-2.11.1">&#21518;&#36864;</a>
          <p>
            Glibc-2.11.1
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="zlib.html" title="Zlib-1.2.3">&#21069;&#36827;</a>
          <p>
            Zlib-1.2.3
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter06.html" title=
          "Chapter&nbsp;6.&nbsp;Installing Basic System Software">&#19978;&#19968;&#32423;</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - Version 6.6">&#39318;&#39029;</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="en" xml:lang="en">
      <h1 class="sect1">
        <a id="ch-system-readjusting" name="ch-system-readjusting"></a>6.10.
        &#20877;&#27425;&#35843;&#25972;&#24037;&#20855;&#38142;
      </h1>
      <p>
        &#29616;&#22312;&#65292;&#26368;&#32456;&#30340; C&#24211;&#24050;&#32463;&#23433;&#35013;&#22909;&#20102;&#65292; &#25105;&#20204;&#38656;&#35201;&#20877;&#27425;&#35843;&#25972;&#24037;&#20855;&#38142;&#65292; &#35753;&#26412;&#31456;&#38543;&#21518;&#32534;&#35793;&#30340;&#37027;&#20123;&#24037;&#20855;&#37117;&#36830;&#25509;&#21040;&#36825;&#20010;&#24211;&#19978;&#12290;        &#22522;&#26412;&#19978;&#65292;&#23601;&#26159;&#25226; <a class=
        "xref" href="../chapter05/chapter05.html" title=
        "Chapter&nbsp;5.&nbsp;Constructing a Temporary System">Chapter 5</a> 
        &#20013;&quot;&#35843;&#25972;&#24037;&#20855;&#38142;&quot;&#37027;&#37324;&#20570;&#30340;&#35843;&#25972;&#32473;&#21462;&#28040;&#25481;&#12290; &#22312; <a class="xref" href=
        "../chapter05/chapter05.html" title=
        "Chapter&nbsp;5.&nbsp;Constructing a Temporary System">Chapter 5</a> &#20013;&#65292;&#24037;&#20855;&#38142;&#20351;&#29992;&#30340;&#24211;&#26159;&#20174;&#23487;&#20027;&#31995;&#32479;&#30340; <code class=
        "filename">/{,usr/}lib</code>  &#36716;&#21521;&#26032;&#23433;&#35013;&#30340;<code class=
        "filename">/tools/lib</code> &#30446;&#24405;&#12290;&#21516;&#26679;&#30340;&#65292;&#29616;&#22312;&#24037;&#20855;&#38142;&#20351;&#29992;&#30340;&#24211;&#23558;&#20174;&#20020;&#26102;&#30340; <code class=
        "filename">/tools/lib</code> &#36716;&#21521; LFS &#31995;&#32479;&#26368;&#32456;&#30340; <code class=
        "filename">/{,usr/}lib</code> &#30446;&#24405;&#12290;</p>
      <p>
        &#39318;&#20808;&#65292;&#22791;&#20221; <code class="filename">/tools</code> &#30446;&#24405;&#19979;&#30340;&#38142;&#25509;&#65292; &#29992;&#25105;&#20204;&#22312;&#31532; 5 &#31456;&#20013;&#32534;&#35793;&#30340;&#38142;&#25509;&#22120;&#26469;&#26367;&#25442;&#12290; &#25105;&#20204;&#36824;&#35201;&#21019;&#24314;&#19968;&#20010;&#38142;&#25509;&#21040; <code class=
        "filename">/tools/$(gcc -dumpmachine)/bin</code> &#30340;&#21103;&#26412;&#65306; </p>
      <pre class="userinput"><kbd class=
      "command">mv -v /tools/bin/{ld,ld-old}
mv -v /tools/$(gcc -dumpmachine)/bin/{ld,ld-old}
mv -v /tools/bin/{ld-new,ld}
ln -sv /tools/bin/ld /tools/$(gcc -dumpmachine)/bin/ld</kbd></pre>
      <p>
        &#25509;&#19979;&#26469;&#65292;&#20462;&#27491; GCC &#30340; specs &#25991;&#20214;&#65292;&#20351;&#23427;&#25351;&#21521;&#26032;&#30340;&#21160;&#24577;&#38142;&#25509;&#22120;&#65292;&#21482;&#38656;&#35201;&#21024;&#38500;&ldquo;/tools&rdquo; &#30340;&#25152;&#26377;&#23454;&#20363;&#65292; &#23601;&#20250;&#30041;&#19979;&#25351;&#21521;&#21160;&#24577;&#36830;&#25509;&#22120;&#30340;&#27491;&#30830;&#36335;&#24452;&#12290; &#20063;&#35201;&#35843;&#25972;specs&#25991;&#20214;&#65292; &#36825;&#26679; GCC &#25165;&#33021;&#30693;&#36947;&#22312;&#21738;&#33021;&#25214;&#21040;&#27491;&#30830;&#30340;&#22836;&#25991;&#20214;&#21644;Glibc&#24320;&#22987;&#25991;&#20214;&#12290; &#36816;&#34892;&#19968;&#20010;
        <span class="command"><strong>sed</strong></span> &#21629;&#20196;&#65306;      </p>
      <pre class="userinput"><kbd class=
      "command">gcc -dumpspecs | sed -e 's@/tools@@g' \
    -e '/\*startfile_prefix_spec:/{n;s@.*@/usr/lib/ @}' \
    -e '/\*cpp:/{n;s@$@ -isystem /usr/include@}' &gt; \
    `dirname $(gcc --print-libgcc-file-name)`/specs</kbd></pre>
      <p>&#26368;&#22909;&#29992;&#20320;&#30340;&#30524;&#30555;&#20146;&#33258;&#26816;&#26597;&#19968;&#19979; specs &#25991;&#20214;&#65292;&#20197;&#30830;&#20445;&#24050;&#32463;&#25913;&#27491;&#30830;&#20102;&#12290;</p>
      <p>
        &#29616;&#22312;&#26377;&#24517;&#35201;&#20572;&#19979;&#26469;&#65292;&#26816;&#26597;&#19968;&#19979;&#35843;&#25972;&#36807;&#30340;&#24037;&#20855;&#38142;&#30340;&#22522;&#26412;&#21151;&#33021;(&#32534;&#35793;&#21644;&#36830;&#25509;)&#26159;&#21542;&#27491;&#24120;&#65292; &#25105;&#20204;&#36827;&#34892;&#19979;&#38754;&#30340;&#21512;&#29702;&#24615;&#26816;&#26597;&#65306;</p>
      <pre class="userinput"><kbd class=
      "command">echo 'main(){}' &gt; dummy.c
cc dummy.c -v -Wl,--verbose &amp;&gt; dummy.log
readelf -l a.out | grep ': /lib'</kbd></pre>
      <p>
        &#22914;&#26524;&#19968;&#20999;&#27491;&#24120;&#65292;&#24212;&#35813;&#19981;&#20250;&#20986;&#38169;&#65292;&#32780;&#19988;&#26368;&#21518;&#19968;&#20010;&#21629;&#20196;&#30340;&#32467;&#26524;&#24212;&#35813;&#26159;(&#26576;&#20123;&#29305;&#27530;&#24179;&#21488;&#19978;&#21160;&#24577;&#36830;&#25509;&#22120;&#30340;&#21517;&#31216;&#21487;&#33021;&#19982;&#27492;&#22788;&#19981;&#21516;):
      </p>
      <pre class="screen"><code class=
      "computeroutput">[Requesting program interpreter: /lib/ld-linux.so.2]</code></pre>
      <p>
        &#27880;&#24847;&#29616;&#22312; <code class="filename">/lib</code> &#24212;&#35813;&#26159;&#21160;&#24577;&#36830;&#25509;&#22120;&#30340;&#21069;&#32512;&#12290;</p>
      <p>&#29616;&#22312;&#30830;&#20445;&#25105;&#20204;&#35774;&#32622;&#20351;&#29992;&#27491;&#30830;&#30340;&#24320;&#22987;&#25991;&#20214;&#65306;</p>
      <pre class="userinput"><kbd class=
      "command">grep -o '/usr/lib.*/crt[1in].*succeeded' dummy.log</kbd></pre>
      <p>
        &#22914;&#26524;&#19968;&#20999;&#27491;&#24120;&#65292;&#24212;&#35813;&#19981;&#20250;&#20986;&#38169;&#65292;&#32780;&#19988;&#26368;&#21518;&#19968;&#20010;&#21629;&#20196;&#30340;&#32467;&#26524;&#24212;&#35813;&#26159;:
      </p>
      <pre class="screen"><code class=
      "computeroutput">/usr/lib/crt1.o succeeded
/usr/lib/crti.o succeeded
/usr/lib/crtn.o succeeded</code></pre>
      <p>
        &#39564;&#35777;&#32534;&#35793;&#22120;&#22312;&#25628;&#32034;&#27491;&#30830;&#30340;&#22836;&#25991;&#20214;&#65306;:
      </p>
      <pre class="userinput"><kbd class=
      "command">grep -B1 '^ /usr/include' dummy.log</kbd></pre>
      <p>&#36825;&#20010;&#21629;&#20196;&#24212;&#35813;&#25104;&#21151;&#30340;&#36820;&#22238;&#19979;&#38754;&#30340;&#36755;&#20986;&#65306;</p>
      <pre class="screen"><code class=
      "computeroutput">#include &lt;...&gt; search starts here:
 /usr/include</code></pre>
      <p>&#25509;&#19979;&#26469;&#35201;&#20570;&#30340;&#26159;&#39564;&#35777;&#26032;&#30340;&#38142;&#25509;&#22120;&#26159;&#21542;&#22312;&#27491;&#30830;&#30340;&#25628;&#32034;&#36335;&#24452;&#20869;&#65306;</p>
      <pre class="userinput"><kbd class=
      "command">grep 'SEARCH.*/usr/lib' dummy.log |sed 's|; |\n|g'</kbd></pre>
      <p>
        &#22914;&#26524;&#19968;&#20999;&#27491;&#24120;&#65292;&#24212;&#35813;&#19981;&#20250;&#20986;&#38169;&#65292;&#32780;&#19988;&#26368;&#21518;&#19968;&#20010;&#21629;&#20196;&#30340;&#32467;&#26524;&#24212;&#35813;&#26159;(&#26576;&#20123;&#29305;&#27530;&#24179;&#21488;&#19978;&#30340;&#36755;&#20986;&#21487;&#33021;&#19982;&#27492;&#22788;&#19981;&#21516;):
      </p>
      <pre class="screen"><code class=
      "computeroutput">SEARCH_DIR("/tools/i686-pc-linux-gnu/lib")
SEARCH_DIR("/usr/lib")
SEARCH_DIR("/lib");</code></pre>
      <p>
        &#19979;&#38754;&#65292;&#30830;&#20445;&#25105;&#20204;&#27491;&#22312;&#20351;&#29992;&#27491;&#30830;&#30340;libc&#65306;</p>
      <pre class="userinput"><kbd class=
      "command">grep "/lib.*/libc.so.6 " dummy.log</kbd></pre>
      <p>
        &#22914;&#26524;&#19968;&#20999;&#27491;&#24120;&#65292;&#24212;&#35813;&#19981;&#20250;&#20986;&#38169;&#65292;&#32780;&#19988;&#26368;&#21518;&#19968;&#20010;&#21629;&#20196;&#30340;&#32467;&#26524;&#24212;&#35813;&#26159; (&#22312;64&#20301;&#23487;&#20027;&#31995;&#32479;&#19978;&#65292;&#26159; lib64 &#30446;&#24405;&#65289;:
      </p>
      <pre class="screen"><code class=
      "computeroutput">attempt to open /lib/libc.so.6 succeeded</code></pre>
      <p>
        &#26368;&#21518;&#65292;&#30830;&#20445; GCC &#27491;&#22312;&#20351;&#29992;&#27491;&#30830;&#30340;&#21160;&#24577;&#38142;&#25509;&#22120;&#65306;</p>
      <pre class="userinput"><kbd class=
      "command">grep found dummy.log</kbd></pre>
      <p>
        &#22914;&#26524;&#19968;&#20999;&#27491;&#24120;&#65292;&#24212;&#35813;&#19981;&#20250;&#20986;&#38169;&#65292;&#32780;&#19988;&#26368;&#21518;&#19968;&#20010;&#21629;&#20196;&#30340;&#32467;&#26524;&#24212;&#35813;&#26159;(&#26576;&#20123;&#29305;&#27530;&#24179;&#21488;&#19978;&#21160;&#24577;&#36830;&#25509;&#22120;&#30340; &#21517;&#31216;&#21487;&#33021;&#19982;&#27492;&#22788;&#19981;&#21516;&#65292; &#22312;64&#20026;&#31995;&#32479;&#19978;&#65292;&#26159; lib64 &#30446;&#24405;):      </p>
      <pre class="screen"><code class=
      "computeroutput">found ld-linux.so.2 at /lib/ld-linux.so.2</code></pre>
      <p>
        &#22914;&#26524;&#36755;&#20986;&#19982;&#19978;&#38754;&#19981;&#21516;&#25110;&#32773;&#27809;&#26377;&#36755;&#20986;&#65292;&#37027;&#20040;&#23601;&#26377;&#22823;&#38382;&#39064;&#20102;&#12290;&#20320;&#38656;&#35201;&#26816;&#26597;&#19968;&#19979;&#21069;&#38754;&#30340;&#25805;&#20316;&#65292;&#30475;&#30475;&#38382;&#39064;&#20986;&#22312;&#21738;&#37324;&#65292;&#24182;&#25913;&#27491;&#36807;&#26469;&#12290; &#22823;&#22810;&#25968;&#24773;&#20917;&#19979;&#65292;&#20986;&#38169;&#37117;&#26159;&#22240;&#20026;&#19978;&#38754;&#30340; specs &#25991;&#20214;&#27809;&#25913;&#23545;&#12290; &#22312;&#32487;&#32493;&#20043;&#21069;&#35201;&#35299;&#20915;&#25152;&#26377;&#30340;&#38382;&#39064;&#12290;
</p>
      <p>
        &#22312;&#30830;&#23450;&#19968;&#20999;&#27491;&#24120;&#21518;&#65292;&#21024;&#38500;&#27979;&#35797;&#25991;&#20214;&#65306;
      </p>
      <pre class="userinput"><kbd class=
      "command">rm -v dummy.c a.out dummy.log</kbd></pre>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="glibc.html" title="Glibc-2.11.1">&#21518;&#36864;</a>
          <p>
            Glibc-2.11.1
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="zlib.html" title="Zlib-1.2.3">&#21069;&#36827;</a>
          <p>
            Zlib-1.2.3
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="chapter06.html" title=
          "Chapter&nbsp;6.&nbsp;Installing Basic System Software">&#19978;&#19968;&#32423;</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Linux From Scratch - Version 6.6">&#39318;&#39029;</a>
        </li>
      </ul>
    </div>
  </body>
</html>
